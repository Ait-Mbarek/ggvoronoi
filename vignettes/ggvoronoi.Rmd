---
title: "Voronoi Diagrams with ggvoronoi"
author: "Robert Garrett"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Voronoi Diagrams with ggvoronoi}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```


With ggvoronoi we can easily draw Voronoi diagram heatmaps, with help from packages deldir and ggplot2. 
A Voronoi diagram draws the nearest neighbor regions around a set of points, and by specifying a fill argument we can turn that into a heatmap!
Applications of voronoi diagrams include:

- finding the one nearest neighbor to a given point
- interpolating a set of points without using a raster
- creating useful and appealing graphics

## Voronoi Diagram Simulation

Let's create some data to use as an example.

```{r 1a}
library(ggvoronoi)
set.seed(45056)
x = sample(1:200,100)
y = sample(1:200,100)
points = data.frame(x, y,
                    distance = sqrt((x-100)^2 + (y-100)^2))
circle = data.frame(x = 100*(1+cos(seq(0, 2*pi, length.out = 2500))),
                    y = 100*(1+sin(seq(0, 2*pi, length.out = 2500))),
                    group = rep(1,2500))

ggplot(points)+
  geom_point(aes(x,y,color=distance))+
  geom_path(data=circle,aes(x,y,group=group))
```

All this data has is a set of x and y coordinates, along with the euclidean distance from the center of the circle which we will use to color the voronoi diagram.

ggvoronoi can use this set of points to quickly plot a Voronoi diagram, working with the ggplot2 framework:

```{r 1b}
ggplot(points)+
  geom_voronoi(aes(x,y,fill=distance))
```

Additionally, we can use the stat_voronoi function directly to specify which ggplot 2 geom we would like to use.
This is most useful when we are interested in plotting only the borders of the diagram:

```{r 1c}
ggplot(points,aes(x,y))+
  stat_voronoi(geom="path")+
  geom_point()
```

This last plot brings up and interesting point: the deldir package creates the  voronoi diagram with an automatic bounding box (otherwise it would be infinitely large!). But, we can specify our own bounding box to shrink or enlarge the area.

The outline argument must have these parameters:

- first column is x/longitude
- second column is y/latitude
- optional column "group"

Or you can feed it any SpatialPolygonsDataFrame!

For this example, we will use the circle included with ggvoronoi.

```{r 1d}
ggplot(data=points, aes(x=x, y=y, fill=distance)) + 
  geom_voronoi(outline = circle)
```

Finally, you can add whatever you want with your knowledge of ggplot2!

```{r 1e}
ggplot(points,aes(x,y))+
  geom_voronoi(aes(fill=distance),outline=circle,color="#4dffb8",size=.125)+
  scale_fill_gradient(low="#4dffb8",high="black",guide=F)+
  theme_void()+
  coord_fixed()
```
